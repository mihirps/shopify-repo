{% liquid
  assign theme_rtl = false
  if settings.rtl_enable and settings.langauges_rtl == blank
    assign theme_rtl = true
  endif

  if settings.rtl_enable and settings.langauges_rtl != blank
    assign rtl_languages = settings.langauges_rtl | split: ','
    for language in rtl_languages
      if language == request.locale.iso_code
        assign theme_rtl = true
      endif
    endfor
  endif
%}
<!doctype html>
<html class="no-js supports-no-cookies" lang="{{ request.locale.iso_code }}" {% if theme_rtl %}dir="rtl"{% endif %}>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="{{ settings.color_primary }}">
  <link rel="canonical" href="{{canonical_url}}">
  {%- if settings.favicon != blank -%}
  <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png" />
  {%- endif -%}
  
  <!-- Resource hints - reduced to critical connections only -->
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://ajax.googleapis.com" crossorigin>
  
  <!-- CRITICAL CSS INLINE -->
  <style>
    /* Critical CSS for above-the-fold content */
    /* Include only what's needed for header, hero section, etc. */
    body{margin:0;padding:0}
    .header{display:block;width:100%}
    /* Include more critical styles here, focusing on what's visible in the viewport */
  </style>
  
  <!-- Preload ONLY the hero/LCP image -->
  {% if template == 'index' %}
    {% if sections.hero-image %}
      <link rel="preload" as="image" href="{{ sections.hero-image.settings.image | img_url: 'master' }}">
    {% endif %}
  {% endif %}
  
  <!-- Preload critical fonts with optimal settings -->
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Lato:400&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400&display=swap"></noscript>
  
  <!-- Defer non-critical CSS -->
  <link rel="stylesheet" href="{{ 'timber.css' | asset_url }}" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="{{ 'vendor.css' | asset_url }}" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="{{ 'slick.min.css' | asset_url }}" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="{{ 'style.css' | asset_url }}" media="print" onload="this.media='all'">
  
  {%- if settings.dark_enable -%}
    <link rel="stylesheet" href="{{ 'dark.css' | asset_url }}" media="print" onload="this.media='all'">
  {%- endif -%}
  
  {% if theme_rtl %}
    <link rel="stylesheet" href="{{ 'theme-rtl.css' | asset_url }}" media="print" onload="this.media='all'">
  {%- endif -%}
  
  <link rel="stylesheet" href="{{ 'skin-and-color.css' | asset_url }}" media="print" onload="this.media='all'">
  <noscript>
    <link rel="stylesheet" href="{{ 'timber.css' | asset_url }}">
    <link rel="stylesheet" href="{{ 'vendor.css' | asset_url }}">
    <link rel="stylesheet" href="{{ 'style.css' | asset_url }}">
    <!-- Other CSS files -->
  </noscript>
  
  <!-- Critical JS only - Defer everything else -->
  <script src="{{ 'lazysizes.min.js' | asset_url }}" async></script>
  
  <!-- Title and description -->
  {%- capture seo_title -%}
  {{ page_title }}
  {%- if current_tags -%}
  {%- assign meta_tags = current_tags | join: ', ' %} &ndash; {{ 'general.meta.tags' | t: tags: meta_tags -}}
  {% endif %}
  {%- if current_page != 1 -%}
  &ndash; {{ 'general.meta.page' | t: page: current_page }}
  {%- endif -%}
  {%- unless page_title contains shop.name -%}
  &ndash; {{ shop.name }}
  {%- endunless -%}
  {%- endcapture -%}
  <title>{{ seo_title }}</title>
  {%- if page_description -%}
  <meta name="description" content="{{ page_description | escape }}">
  {%- endif -%}
  
  <!-- Helpers -->
  {%- render 'social-meta-tags', product: product, article: article -%}
  
  {{ content_for_header }}
  
  <!-- Moved render calls to footer where possible -->
</head>
<body id="{{ page_title | handle }}" class="{% if customer %}customer-logged-in {% endif %}template-{{ template.name | handle }}" >
  {%- if settings.enable_preloader -%}
  {%- render 'preloader' -%} 
  {%- endif -%}
  {%- if template == 'index' and settings.newsletter_popup_enable -%}
  {%- render 'newsletter-popup' -%}
  {%- endif -%}
  
  <div class="wrapper{% if settings.box_layout_enable %} wrapper-box{% endif %}" {% if template == 'collection' %}id="form_output"{% endif %}>
    {%- if settings.topbar_notification_enable -%}
    {%- if settings.topbar_notification == 'topbar_in_index' and template == 'index' -%}
    {%- render 'top-notification-bar' -%}
    {%- elsif settings.topbar_notification == 'topbar_in_template' -%}
    {%- render 'top-notification-bar' -%}
    {%- endif -%}
    {%- endif -%}
    
    {% sections 'header-group' %}  
    
    {%- if template != 'index' -%}
    {%- section 'breadcrumb' -%}
    {%- endif -%}
    <main>
      {{ content_for_layout }}
    </main> 

    {% sections 'footer-group' %}
  </div>
  
  {%- if settings.compare_product_enalbe -%}
  {%- render 'compare-popup' -%}
  {%- endif -%}
  <!-- Necessary JS -->
  {%- render 'footer-js' with content_for_layout as content_for_layout -%}
</body>
</html>