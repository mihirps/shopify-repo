{%- capture responsive_image_counter %}{% increment responsive_image_counter %}{% endcapture -%}
{%- assign img_url = image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
{%- comment -%} Limit image widths to valid options based on image.width {%- endcomment -%}
{%- assign image_widths = '180,360,540,720,900,1080,1296,1512,1728,1944,2160,2376,2592,2808,3024' | split: ',' -%}
{%- capture image_widths -%}
{%- for width in image_widths -%}
{%- comment -%} Check if image width is less or equal to width {%- endcomment -%}
{%- assign width_num = width | plus: 0 | round -%}
{%- if image.width >= width_num -%}{{ width_num }},{%- endif -%}
{%- endfor -%}
{{ image.width }}
{%- endcapture -%}
{%- assign image_widths = image_widths | strip -%}
<img src="{{ img_url }}"
  {%- if image.alt -%}
    alt="{{ image.alt | escape }}"
  {%- else -%}
    alt=""
  {%- endif -%}
  width="{{ image.width }}"
  height="{{ image.height }}"
  loading="lazy"
  class="{{ img_class }}"
>